本次会议介绍了大模型推理长度预测的技术发展，聚焦于Hidden States预测新范式，探讨其对调度策略的实际影响及验证方法。

## 小结
**1. 推理长度预测的技术发展回顾**
- **早期方法**： 最初在Prompt中注入提示词（如“估计输出约xx个Token”），或使用tiny transformer模型进行预测。尽管效果不错，但存在“修改大模型”的争议。
- **主流新范式**： 近年来，特别是2025年，研究趋势已全面转向基于模型**Hidden States**的预测。该方法通过对执行过程中提取的隐藏状态（Hybrid States）训练一个简单的线性分类器或MLP进行预测，相比基于Prompt的方法，预测精度显著更高。

**2. 调度策略及其商业化场景**
- **基于预测结果的策略**：
    - 将具有相似长度的任务聚合（batching）并同时开始/结束，以提高硬件利用率。
    - 优先调度预测长度短的任务，以缩短排队等待时间。
    - 结合抢占机制，动态地在长、短任务之间交换（swap），但会对已完成较长任务的请求增加抢占保护。
- **应用场景拓展**： 在多应用云服务场景下，结合用户类型、历史指令等信息可提升预测准确率。在强化学习等需要大量长序列推理的场景中，通过长度预测可解决长尾效应，显著提升训练效率。

**3. 现有评估方法与讨论**
- 为评估调度优化方案的有效性，与会者探讨了“上帝视角”（%100准确前提）下的方法论。理想的验证场景应假设获取到每个请求精确的长度信息，在此基础上设计并验证最优调度策略。
- 讨论中对现有调度策略（如仅按长度分组）的有效性产生疑虑，尤其是在支持continue-serving的环境下，认为可能需要更具创新性的策略来充分挖掘潜在价值。

## 待办
**1. 鉴于现有结果有限，需探索更创新的调度策略**
- 将在后续的工作中，先假定拥有绝对准确的请求长度信息作为理想条件，探索和测试具有创新性的调度策略，以测试方案的理论潜力和优化上限。

**2. 构建用于验证的“上帝视角”数据集**
- 如何创建一个理想环境中，每个请求输出长度已知的greatest dataset。
- 参考思路包括：在生成请求时指定最大输出长度、“忽略输入结束符”参数设置；或在prompt中加入指令（如“请输出100个字符”）。

## 录屏
https://www.bilibili.com/video/BV1KYyGBsEvp/